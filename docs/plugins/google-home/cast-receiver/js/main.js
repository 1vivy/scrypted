(()=>{"use strict";var __webpack_modules__={636:(module,__webpack_exports__,__webpack_require__)=>{function startPeriodicGarbageCollection(){let e;__webpack_require__.g.gc||console.warn("rpc peer garbage collection not available: global.gc is not exposed.");try{e=__webpack_require__.g}catch(e){}let t=0;return setInterval((()=>{const r=Date.now(),i=r-t,o=RpcPeer.remotesCreated;RpcPeer.remotesCreated=0;const n=RpcPeer.remotesCollected;RpcPeer.remotesCollected=0,(o||n||i>3e5)&&(t=r,e?.gc?.())}),1e4)}__webpack_require__.d(__webpack_exports__,{uD:()=>RpcPeer}),module=__webpack_require__.hmd(module);class RpcProxy{peer;entry;constructorName;proxyProps;proxyOneWayMethods;constructor(e,t,r,i,o){this.peer=e,this.entry=t,this.constructorName=r,this.proxyProps=i,this.proxyOneWayMethods=o}toPrimitive(){const e=this.peer;return`RpcProxy-${e.selfName}:${e.peerName}: ${this.constructorName}`}get(e,t,r){if(t===RpcPeer.PROPERTY_PROXY_ID)return this.entry.id;if("__proxy_constructor"===t)return this.constructorName;if("__proxy_peer"===t)return this.peer;if(t===RpcPeer.PROPERTY_PROXY_PROPERTIES)return this.proxyProps;if(t===RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS)return this.proxyOneWayMethods;if(t===RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION||t===RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN)return;if("then"===t)return;if("constructor"===t)return;if(void 0!==this.proxyProps?.[t])return this.proxyProps?.[t];return RpcPeer.handleFunctionInvocations(this,e,t,r)||new Proxy((()=>t),this)}set(e,t,r,i){return t===RpcPeer.finalizerIdSymbol?this.entry.finalizerId=r:(this.proxyProps||={},this.proxyProps[t]=r),!0}apply(e,t,r){if(Object.isFrozen(this.peer.pendingResults))return Promise.reject(new RPCResultError(this.peer,"RpcPeer has been killed"));const i=e()||null,o=[],n={};for(const e of r||[])o.push(this.peer.serialize(e,n));const s={type:"apply",id:void 0,proxyId:this.entry.id,args:o,method:i};return this.proxyOneWayMethods?.includes?.(i)?(s.oneway=!0,null===i&&delete s.method,this.peer.send(s,void 0,n),Promise.resolve()):this.peer.createPendingResult(((e,t)=>{s.id=e,this.peer.send(s,t,n)}))}}class RPCResultError extends Error{cause;constructor(e,t,r,i){super(`${e.selfName}:${e.peerName}: ${t}`),this.cause=r,i?.name&&(this.name=i?.name),i?.stack&&(this.stack=`${e.peerName}:${e.selfName}\n${r?.stack||i.stack}`)}}function compileFunction(code,params,options){params=params||[];const f=`(function(${params.join(",")}) {;${code};})`;return eval(f)}try{const e=FinalizationRegistry}catch(e){window.WeakRef=class{target;constructor(e){this.target=e}deref(){return this.target}},window.FinalizationRegistry=class{register(){}}}class RpcPeer{selfName;peerName;send;idCounter=1;params={};pendingResults={};proxyCounter=1;localProxied=new Map;localProxyMap={};remoteWeakProxies={};finalizers=new FinalizationRegistry((e=>this.finalize(e)));nameDeserializerMap=new Map;constructorSerializerMap=new Map;transportSafeArgumentTypes=RpcPeer.getDefaultTransportSafeArgumentTypes();killed;killedDeferred;tags={};static finalizerIdSymbol=Symbol("rpcFinalizerId");static remotesCollected=0;static remotesCreated=0;static activeRpcPeer;static isRpcProxy(e){return!!e?.[RpcPeer.PROPERTY_PROXY_ID]}static getDefaultTransportSafeArgumentTypes(){const e=new Set;return e.add(Number.name),e.add(String.name),e.add(Object.name),e.add(Boolean.name),e.add(Array.name),e}static handleFunctionInvocations(e,t,r,i){return"apply"===r?(r,i)=>e.apply(t,e,i):"call"===r?(r,...i)=>e.apply(t,e,i):"toString"===r||r===Symbol.toPrimitive?(t,...r)=>e.toPrimitive():void 0}static PROPERTY_PROXY_ID="__proxy_id";static PROPERTY_PROXY_ONEWAY_METHODS="__proxy_oneway_methods";static PROPERTY_JSON_DISABLE_SERIALIZATION="__json_disable_serialization";static PROPERTY_PROXY_PROPERTIES="__proxy_props";static PROPERTY_JSON_COPY_SERIALIZE_CHILDREN="__json_copy_serialize_children";static PROBED_PROPERTIES=new Set(["then","constructor","__proxy_id","__proxy_constructor","__proxy_peer",RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS,RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION,RpcPeer.PROPERTY_PROXY_PROPERTIES,RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN]);constructor(e,t,r){this.selfName=e,this.peerName=t,this.send=r,this.killed=new Promise(((e,t)=>{this.killedDeferred={resolve:e,reject:t}})),this.killed.catch((()=>{}))}createPendingResult(e){if(Object.isFrozen(this.pendingResults))return Promise.reject(new RPCResultError(this,"RpcPeer has been killed"));const t=new Promise(((t,r)=>{const i=(this.idCounter++).toString();this.pendingResults[i]={resolve:t,reject:r},e(i,(e=>r(new RPCResultError(this,e.message,e))))}));return t.catch((()=>{})),t}kill(e){const t=new RPCResultError(this,e||"peer was killed");this.killedDeferred.reject(t);for(const e of Object.values(this.pendingResults))e.reject(t);this.pendingResults=Object.freeze({}),this.params=Object.freeze({}),this.remoteWeakProxies=Object.freeze({}),this.localProxyMap=Object.freeze({}),this.localProxied.clear()}addSerializer(e,t,r){this.nameDeserializerMap.set(t,r),this.constructorSerializerMap.set(e,t)}finalize(e){RpcPeer.remotesCollected++,delete this.remoteWeakProxies[e.id];const t={__local_proxy_id:e.id,__local_proxy_finalizer_id:e.finalizerId,type:"finalize"};this.send(t)}async getParam(e){return this.createPendingResult(((t,r)=>{const i={id:t,type:"param",param:e};this.send(i,r)}))}evalLocal(e,t,r){const i=Object.assign({},this.params,r);let o;try{o=module.require("vm").compileFunction}catch(e){o=compileFunction}return o(e,Object.keys(i),{filename:t})(...Object.values(i))}createErrorResult(e,t){e.stack=t.stack||"no stack",e.result=t.name||"no name",e.message=t.message||"no message"}deserialize(e,t){if(!e)return e;if(e[RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN]){const r={};for(const[i,o]of Object.entries(e))r[i]=this.deserialize(o,t);return r}const{__remote_proxy_id:r,__remote_proxy_finalizer_id:i,__local_proxy_id:o,__remote_constructor_name:n,__serialized_value:s,__remote_proxy_props:a,__remote_proxy_oneway_methods:c}=e;if(r){let e=this.remoteWeakProxies[r]?.deref();e||(e=this.newProxy(r,n,a,c)),e[RpcPeer.finalizerIdSymbol]=i;const o=this.nameDeserializerMap.get(n);return o?o.deserialize(e,t):e}if(o){const e=this.localProxyMap[o];if(!e)throw new RPCResultError(this,`invalid local proxy id ${o}`);return e}const _=this.nameDeserializerMap.get(n);return _?_.deserialize(s,t):e}serialize(e,t){if(!0===e?.[RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN]){const r={};for(const[i,o]of Object.entries(e))r[i]=this.serialize(o,t);return r}if(!e||!e[RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION]&&this.transportSafeArgumentTypes.has(e.constructor?.name))return e;let r=e.__proxy_constructor||e.constructor?.name?.toString(),i=this.localProxied.get(e);if(i){const t=(this.proxyCounter++).toString();return i.finalizerId=t,{__remote_proxy_id:i.id,__remote_proxy_finalizer_id:t,__remote_constructor_name:r,__remote_proxy_props:e?.[RpcPeer.PROPERTY_PROXY_PROPERTIES],__remote_proxy_oneway_methods:e?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS]}}const{__proxy_id:o,__proxy_peer:n}=e;if(o&&n===this)return{__local_proxy_id:o};const s=this.constructorSerializerMap.get(e.constructor);if(s){r=s;const i=this.nameDeserializerMap.get(s);if(!i)throw new Error("serializer not found for "+s);const o=i.serialize(e,t);return{__remote_proxy_id:void 0,__remote_proxy_finalizer_id:void 0,__remote_constructor_name:r,__remote_proxy_props:e?.[RpcPeer.PROPERTY_PROXY_PROPERTIES],__remote_proxy_oneway_methods:e?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS],__serialized_value:o}}const a=(this.proxyCounter++).toString();return i={id:a,finalizerId:a},this.localProxied.set(e,i),this.localProxyMap[a]=e,{__remote_proxy_id:a,__remote_proxy_finalizer_id:a,__remote_constructor_name:r,__remote_proxy_props:e?.[RpcPeer.PROPERTY_PROXY_PROPERTIES],__remote_proxy_oneway_methods:e?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS]}}newProxy(e,t,r,i){RpcPeer.remotesCreated++;const o={id:e,finalizerId:void 0},n=new RpcProxy(this,o,t,r,i),s=new Proxy("Function"===t||"AsyncFunction"===t?function(){}:n,n),a=new WeakRef(s);return this.remoteWeakProxies[e]=a,this.finalizers.register(n,o),s}handleMessage(e,t){try{RpcPeer.activeRpcPeer=this,this.handleMessageInternal(e,t)}finally{RpcPeer.activeRpcPeer=void 0}}async handleMessageInternal(e,t){if(!Object.isFrozen(this.pendingResults))try{switch(e.type){case"param":{const t=e,r={},i={type:"result",id:t.id,result:this.serialize(this.params[t.param],r)};this.send(i,void 0,r);break}case"apply":{const r=e,i={type:"result",id:r.id||""},o={};try{const e=this.localProxyMap[r.proxyId];if(!e)throw new Error(`proxy id ${r.proxyId} not found`);const n=[];for(const e of r.args||[])n.push(this.deserialize(e,t));let s;if(r.method){if(!e[r.method])throw new Error(`target ${e?.constructor?.name} does not have method ${r.method}`);s=await e[r.method](...n)}else s=await e(...n);i.result=this.serialize(s,o)}catch(e){this.createErrorResult(i,e)}r.oneway||this.send(i,void 0,o);break}case"result":{const r=e,i=this.pendingResults[r.id];if(delete this.pendingResults[r.id],!i)throw new Error(`unknown result ${r.id}`);if(r.message||r.stack){const e=new RPCResultError(this,r.message||"no message",void 0,{name:r.result,stack:r.stack});return void i.reject(e)}i.resolve(this.deserialize(r.result,t));break}case"finalize":{const t=e,r=this.localProxyMap[t.__local_proxy_id];if(r){const e=this.localProxied.get(r);if(t.__local_proxy_finalizer_id&&t.__local_proxy_finalizer_id!==e?.finalizerId)break;delete this.localProxyMap[t.__local_proxy_id],this.localProxied.delete(r)}break}default:throw new Error(`unknown rpc message type ${e.type}`)}}catch(e){return void console.error("unhandled rpc error",this.peerName,e)}}}function getEvalSource(){return`\n    (() => {\n        ${RpcProxy}\n\n        ${RpcPeer}\n    \n        return {\n            RpcPeer,\n            RpcProxy,\n        };\n    })();\n    `}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e=__webpack_require__(636);class t{finished=!1;resolve;reject;promise=new Promise(((e,t)=>{this.resolve=t=>{this.finished=!0,e(t)},this.reject=e=>{this.finished=!0,t(e)}}))}function r(){try{return navigator.userAgent}catch(e){}}function i(e){return new Promise((t=>{e.addEventListener("iceconnectionstatechange",(()=>{o(e)&&t(e.iceConnectionState)}))}))}function o(e){return"disconnected"===e.iceConnectionState||"failed"===e.iceConnectionState||"closed"===e.iceConnectionState}class n{pc;pcDeferred=new t;dcDeferred=new t;microphone;micEnabled=!1;onPeerConnection;options={userAgent:r(),capabilities:{audio:RTCRtpReceiver.getCapabilities?.("audio")||{codecs:void 0,headerExtensions:void 0},video:RTCRtpReceiver.getCapabilities?.("video")||{codecs:void 0,headerExtensions:void 0}},screen:{devicePixelRatio:window.devicePixelRatio,width:screen.width,height:screen.height}};constructor(){}async getOptions(){return this.options}async setMicrophone(e){if(this.microphone&&e&&!this.micEnabled){this.micEnabled=!0;const e=await navigator.mediaDevices.getUserMedia({video:!1,audio:!0});await this.microphone.replaceTrack(e.getTracks()[0])}this.microphone.track.enabled=e}close(){this.pcDeferred.promise.then((e=>{for(const t of e.getTransceivers()||[])try{t.sender?.track?.stop?.()}catch(e){}e.close()})).catch((()=>{})),this.pcDeferred.reject(new Error("iceConnectionState "+this.pc?.iceConnectionState))}async createPeerConnection(e){if(this.pc)return;const t=this.pc=new RTCPeerConnection(e.configuration);if(this.pcDeferred.resolve(t),await(this.onPeerConnection?.(t)),t.addEventListener("iceconnectionstatechange",(()=>{console.log("iceConnectionState",t.iceConnectionState),console.log("connectionState",t.connectionState),o(t)&&this.close()})),e.datachannel){const r=t.createDataChannel(e.datachannel.label,e.datachannel.dict);r.binaryType="arraybuffer",this.dcDeferred.resolve(r)}if(e.audio){let r;r=e.getUserMediaSafariHack&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?t.addTransceiver("audio",{...e.audio,streams:[await navigator.mediaDevices.getUserMedia({audio:!0})]}):t.addTransceiver("audio",e.audio),"sendrecv"!==e.audio.direction&&"sendonly"!==e.audio.direction||(this.microphone=r.sender)}if(e.video)if("sendrecv"===e.video.direction||"sendonly"===e.video.direction)try{const e=await navigator.mediaDevices.getUserMedia({video:!0});for(const r of e.getTracks())t.addTrack(r)}catch(e){}else t.addTransceiver("video",e.video)}async createLocalDescription(e,t,r){await this.createPeerConnection(t);const i=new Promise((e=>{this.pc.onicecandidate=t=>{t.candidate?r?.(JSON.parse(JSON.stringify(t.candidate))):e(void 0)},this.pc.onicegatheringstatechange=()=>{"complete"===this.pc.iceGatheringState&&e(void 0)}})),o=e=>({type:e.type,sdp:e.sdp});if("offer"===e){let e=await this.pc.createOffer({offerToReceiveAudio:!!t.audio,offerToReceiveVideo:!!t.video});const n=this.pc.setLocalDescription(e);return r||(await n,await i,e=await this.pc.createOffer({offerToReceiveAudio:!!t.audio,offerToReceiveVideo:!!t.video})),o(e)}{let e=await this.pc.createAnswer();const t=this.pc.setLocalDescription(e);return r||(await t,await i,e=this.pc.currentLocalDescription||e),o(e)}}async setRemoteDescription(e,t){await this.createPeerConnection(t),await this.pc.setRemoteDescription(e)}async addIceCandidate(e){await this.pc.addIceCandidate(e)}async endSession(){}}document.addEventListener("DOMContentLoaded",(function(t){const r=new cast.framework.CastReceiverOptions;r.disableIdleTimeout=!0,cast.framework.CastReceiverContext.getInstance().start(r);const o=cast.framework.CastReceiverContext.getInstance().getPlayerManager(),s=document.getElementById("media");let a;o.setMessageInterceptor(cast.framework.messages.MessageType.LOAD,(t=>{console.log(t);const r=t.media.entity||t.media.contentId,o=t.credentials??t.media.customData.token,c=new URL(r),_=c.pathname,d={};for(const[e,t]of new URLSearchParams(c.search))d[e]=t;const l={path:_,query:d},p=eio(`wss://${c.host}`,l);return p.on("open",(async()=>{p.send(JSON.stringify({token:o}));const t=new e.uD("cast-receiver","host",((e,t)=>{try{p.send(JSON.stringify(e))}catch(e){t?.(e)}}));p.on("message",(e=>{t.handleMessage(JSON.parse(e))}));const r=new n;r.options.screen.width=1280,r.options.screen.height=720;const c=()=>{console.log("cleanup"),p.close(),r.pcDeferred.promise.then((e=>e.close()))};a?.(),a=c,p.on("close",(()=>{console.log("socket io connection close event"),c()})),r.onPeerConnection=async e=>{i(e).then(c);const t=new MediaStream(e.getReceivers().map((e=>e.track)));e.ontrack=e=>t.addTrack(e.track),s.srcObject=t,function(e){return new Promise(((t,r)=>{"connected"!==e.iceConnectionState?(e.addEventListener("iceconnectionstatechange",(()=>{"connected"===e.iceConnectionState&&t(void 0)})),i(e).then((e=>r(new Error(e))))):t(void 0)}))}(e).then((()=>{p.removeAllListeners()}))},t.params.session=r})),null}))}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWVDLEtBQUt0UyxHQUFhQSxFQUFTd00sU0FDakYzQixFQUFHMEgsUUFBVTlULEdBQUswVCxFQUFZcEUsU0FBU3RQLEVBQUUrTixPQUN6Q1gsRUFBTTJHLFVBQVlMLEVEbEQzQixTQUF3Q3RILEdBQzNDLE9BQU8sSUFBSXpKLFNBQVEsQ0FBQ2UsRUFBU2QsS0FDSyxjQUExQndKLEVBQUdHLG9CQUlQSCxFQUFHQyxpQkFBaUIsNEJBQTRCLEtBQ2QsY0FBMUJELEVBQUdHLG9CQUNIN0ksT0FBUTVCLEVBQVUsSUFFMUJxSyxFQUE0QkMsR0FBSTZCLE1BQUsrRixHQUFVcFIsRUFBTyxJQUFJZ0IsTUFBTW9RLE9BUDVEdFEsT0FBUTVCLEVBTzZELEdBRWpGLENDdUNnQm1TLENBQStCN0gsR0FDMUI2QixNQUFLLEtBQ05pRixFQUFPZ0Isb0JBQW9CLEdBRTdCLEVBRU5aLEVBQVFqUCxPQUFnQixRQUFJbVAsQ0FBTyxJQUVoQyxJQUFJLEdBR25CLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kaXN0L3NlcnZlci9zcmMvcnBjLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvaGFybW9ueSBtb2R1bGUgZGVjb3JhdG9yIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovLy8uL2Rpc3QvY29tbW9uL3NyYy9kZWZlcnJlZC5qcyIsIndlYnBhY2s6Ly8vLi9kaXN0L2NvbW1vbi9zcmMvcnRjLXNpZ25hbGluZy5qcyIsIndlYnBhY2s6Ly8vLi9kaXN0L2RvY3MvcGx1Z2lucy9nb29nbGUtaG9tZS9jYXN0LXJlY2VpdmVyL3NyYy9jYXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBzdGFydFBlcmlvZGljR2FyYmFnZUNvbGxlY3Rpb24oKSB7XG4gICAgaWYgKCFnbG9iYWwuZ2MpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdycGMgcGVlciBnYXJiYWdlIGNvbGxlY3Rpb24gbm90IGF2YWlsYWJsZTogZ2xvYmFsLmdjIGlzIG5vdCBleHBvc2VkLicpO1xuICAgIH1cbiAgICBsZXQgZztcbiAgICB0cnkge1xuICAgICAgICBnID0gZ2xvYmFsO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgIH1cbiAgICAvLyBwZXJpb2RpY2FsbHkgc2VlIGlmIG5ldyBvYmplY3RzIHdlcmUgY3JlYXRlZCBvciBmaW5hbGl6ZWQsXG4gICAgLy8gYW5kIGNvbGxlY3QgZ2MgaWYgc28uXG4gICAgbGV0IGxhc3RDb2xsZWN0aW9uID0gMDtcbiAgICByZXR1cm4gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCBzaW5jZUxhc3RDb2xsZWN0aW9uID0gbm93IC0gbGFzdENvbGxlY3Rpb247XG4gICAgICAgIGNvbnN0IHJlbW90ZXNDcmVhdGVkID0gUnBjUGVlci5yZW1vdGVzQ3JlYXRlZDtcbiAgICAgICAgUnBjUGVlci5yZW1vdGVzQ3JlYXRlZCA9IDA7XG4gICAgICAgIGNvbnN0IHJlbW90ZXNDb2xsZWN0ZWQgPSBScGNQZWVyLnJlbW90ZXNDb2xsZWN0ZWQ7XG4gICAgICAgIFJwY1BlZXIucmVtb3Rlc0NvbGxlY3RlZCA9IDA7XG4gICAgICAgIGlmIChyZW1vdGVzQ3JlYXRlZCB8fCByZW1vdGVzQ29sbGVjdGVkIHx8IHNpbmNlTGFzdENvbGxlY3Rpb24gPiA1ICogNjAgKiAxMDAwKSB7XG4gICAgICAgICAgICBsYXN0Q29sbGVjdGlvbiA9IG5vdztcbiAgICAgICAgICAgIGc/LmdjPy4oKTtcbiAgICAgICAgfVxuICAgIH0sIDEwMDAwKTtcbn1cbmNsYXNzIFJwY1Byb3h5IHtcbiAgICBwZWVyO1xuICAgIGVudHJ5O1xuICAgIGNvbnN0cnVjdG9yTmFtZTtcbiAgICBwcm94eVByb3BzO1xuICAgIHByb3h5T25lV2F5TWV0aG9kcztcbiAgICBjb25zdHJ1Y3RvcihwZWVyLCBlbnRyeSwgY29uc3RydWN0b3JOYW1lLCBwcm94eVByb3BzLCBwcm94eU9uZVdheU1ldGhvZHMpIHtcbiAgICAgICAgdGhpcy5wZWVyID0gcGVlcjtcbiAgICAgICAgdGhpcy5lbnRyeSA9IGVudHJ5O1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yTmFtZSA9IGNvbnN0cnVjdG9yTmFtZTtcbiAgICAgICAgdGhpcy5wcm94eVByb3BzID0gcHJveHlQcm9wcztcbiAgICAgICAgdGhpcy5wcm94eU9uZVdheU1ldGhvZHMgPSBwcm94eU9uZVdheU1ldGhvZHM7XG4gICAgfVxuICAgIHRvUHJpbWl0aXZlKCkge1xuICAgICAgICBjb25zdCBwZWVyID0gdGhpcy5wZWVyO1xuICAgICAgICByZXR1cm4gYFJwY1Byb3h5LSR7cGVlci5zZWxmTmFtZX06JHtwZWVyLnBlZXJOYW1lfTogJHt0aGlzLmNvbnN0cnVjdG9yTmFtZX1gO1xuICAgIH1cbiAgICBnZXQodGFyZ2V0LCBwLCByZWNlaXZlcikge1xuICAgICAgICBpZiAocCA9PT0gUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9JRClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVudHJ5LmlkO1xuICAgICAgICBpZiAocCA9PT0gJ19fcHJveHlfY29uc3RydWN0b3InKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3JOYW1lO1xuICAgICAgICBpZiAocCA9PT0gJ19fcHJveHlfcGVlcicpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wZWVyO1xuICAgICAgICBpZiAocCA9PT0gUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9QUk9QRVJUSUVTKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJveHlQcm9wcztcbiAgICAgICAgaWYgKHAgPT09IFJwY1BlZXIuUFJPUEVSVFlfUFJPWFlfT05FV0FZX01FVEhPRFMpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm94eU9uZVdheU1ldGhvZHM7XG4gICAgICAgIGlmIChwID09PSBScGNQZWVyLlBST1BFUlRZX0pTT05fRElTQUJMRV9TRVJJQUxJWkFUSU9OIHx8IHAgPT09IFJwY1BlZXIuUFJPUEVSVFlfSlNPTl9DT1BZX1NFUklBTElaRV9DSElMRFJFTilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKHAgPT09ICd0aGVuJylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKHAgPT09ICdjb25zdHJ1Y3RvcicpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmICh0aGlzLnByb3h5UHJvcHM/LltwXSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJveHlQcm9wcz8uW3BdO1xuICAgICAgICBjb25zdCBoYW5kbGVkID0gUnBjUGVlci5oYW5kbGVGdW5jdGlvbkludm9jYXRpb25zKHRoaXMsIHRhcmdldCwgcCwgcmVjZWl2ZXIpO1xuICAgICAgICBpZiAoaGFuZGxlZClcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGVkO1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KCgpID0+IHAsIHRoaXMpO1xuICAgIH1cbiAgICBzZXQodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHAgPT09IFJwY1BlZXIuZmluYWxpemVySWRTeW1ib2wpIHtcbiAgICAgICAgICAgIHRoaXMuZW50cnkuZmluYWxpemVySWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJveHlQcm9wcyB8fD0ge307XG4gICAgICAgICAgICB0aGlzLnByb3h5UHJvcHNbcF0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYXBwbHkodGFyZ2V0LCB0aGlzQXJnLCBhcmdBcnJheSkge1xuICAgICAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHRoaXMucGVlci5wZW5kaW5nUmVzdWx0cykpXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFJQQ1Jlc3VsdEVycm9yKHRoaXMucGVlciwgJ1JwY1BlZXIgaGFzIGJlZW4ga2lsbGVkJykpO1xuICAgICAgICAvLyBycGMgb2JqZWN0cyBjYW4gYmUgZnVuY3Rpb25zLiBpZiB0aGUgZnVuY3Rpb24gaXMgYSBvbmV3YXkgbWV0aG9kLFxuICAgICAgICAvLyBpdCB3aWxsIGhhdmUgYSBudWxsIGluIHRoZSBvbmV3YXkgbWV0aG9kIGxpc3QuIHRoaXMgaXMgYmVjYXVzZVxuICAgICAgICAvLyB1bmRlZmluZWQgaXMgbm90IEpTT04gc2VyaWFsaXphYmxlLlxuICAgICAgICBjb25zdCBtZXRob2QgPSB0YXJnZXQoKSB8fCBudWxsO1xuICAgICAgICBjb25zdCBhcmdzID0gW107XG4gICAgICAgIGNvbnN0IHNlcmlhbGl6YXRpb25Db250ZXh0ID0ge307XG4gICAgICAgIGZvciAoY29uc3QgYXJnIG9mIChhcmdBcnJheSB8fCBbXSkpIHtcbiAgICAgICAgICAgIGFyZ3MucHVzaCh0aGlzLnBlZXIuc2VyaWFsaXplKGFyZywgc2VyaWFsaXphdGlvbkNvbnRleHQpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBycGNBcHBseSA9IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXBwbHlcIixcbiAgICAgICAgICAgIGlkOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBwcm94eUlkOiB0aGlzLmVudHJ5LmlkLFxuICAgICAgICAgICAgYXJncyxcbiAgICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMucHJveHlPbmVXYXlNZXRob2RzPy5pbmNsdWRlcz8uKG1ldGhvZCkpIHtcbiAgICAgICAgICAgIHJwY0FwcGx5Lm9uZXdheSA9IHRydWU7XG4gICAgICAgICAgICAvLyBhIG9uZXdheSBjYWxsYWJsZSBvYmplY3QgZG9lc24ndCBuZWVkIHRvIGJlIGluIHRoZSBKU09OIHBheWxvYWQuXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBudWxsKVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBycGNBcHBseS5tZXRob2Q7XG4gICAgICAgICAgICB0aGlzLnBlZXIuc2VuZChycGNBcHBseSwgdW5kZWZpbmVkLCBzZXJpYWxpemF0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucGVlci5jcmVhdGVQZW5kaW5nUmVzdWx0KChpZCwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBycGNBcHBseS5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5wZWVyLnNlbmQocnBjQXBwbHksIHJlamVjdCwgc2VyaWFsaXphdGlvbkNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyB0b2RvOiBlcnJvciBjb25zdHJ1Y3RvciBhZGRzIGEgXCJjYXVzZVwiIHZhcmlhYmxlIGluIENocm9tZSA5MywgTm9kZSB2Pz9cbmV4cG9ydCBjbGFzcyBSUENSZXN1bHRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjYXVzZTtcbiAgICBjb25zdHJ1Y3RvcihwZWVyLCBtZXNzYWdlLCBjYXVzZSwgb3B0aW9ucykge1xuICAgICAgICBzdXBlcihgJHtwZWVyLnNlbGZOYW1lfToke3BlZXIucGVlck5hbWV9OiAke21lc3NhZ2V9YCk7XG4gICAgICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgICAgICAgaWYgKG9wdGlvbnM/Lm5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG9wdGlvbnM/Lm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnM/LnN0YWNrKSB7XG4gICAgICAgICAgICB0aGlzLnN0YWNrID0gYCR7cGVlci5wZWVyTmFtZX06JHtwZWVyLnNlbGZOYW1lfVxcbiR7Y2F1c2U/LnN0YWNrIHx8IG9wdGlvbnMuc3RhY2t9YDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGNvbXBpbGVGdW5jdGlvbihjb2RlLCBwYXJhbXMsIG9wdGlvbnMpIHtcbiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgW107XG4gICAgY29uc3QgZiA9IGAoZnVuY3Rpb24oJHtwYXJhbXMuam9pbignLCcpfSkgezske2NvZGV9O30pYDtcbiAgICByZXR1cm4gZXZhbChmKTtcbn1cbnRyeSB7XG4gICAgY29uc3QgZnIgPSBGaW5hbGl6YXRpb25SZWdpc3RyeTtcbn1cbmNhdGNoIChlKSB7XG4gICAgd2luZG93LldlYWtSZWYgPSBjbGFzcyBXZWFrUmVmIHtcbiAgICAgICAgdGFyZ2V0O1xuICAgICAgICBjb25zdHJ1Y3Rvcih0YXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIGRlcmVmKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICB3aW5kb3cuRmluYWxpemF0aW9uUmVnaXN0cnkgPSBjbGFzcyBGaW5hbGl6YXRpb25SZWdpc3RyeSB7XG4gICAgICAgIHJlZ2lzdGVyKCkge1xuICAgICAgICB9XG4gICAgfTtcbn1cbmV4cG9ydCBjbGFzcyBScGNQZWVyIHtcbiAgICBzZWxmTmFtZTtcbiAgICBwZWVyTmFtZTtcbiAgICBzZW5kO1xuICAgIGlkQ291bnRlciA9IDE7XG4gICAgcGFyYW1zID0ge307XG4gICAgcGVuZGluZ1Jlc3VsdHMgPSB7fTtcbiAgICBwcm94eUNvdW50ZXIgPSAxO1xuICAgIGxvY2FsUHJveGllZCA9IG5ldyBNYXAoKTtcbiAgICBsb2NhbFByb3h5TWFwID0ge307XG4gICAgcmVtb3RlV2Vha1Byb3hpZXMgPSB7fTtcbiAgICBmaW5hbGl6ZXJzID0gbmV3IEZpbmFsaXphdGlvblJlZ2lzdHJ5KGVudHJ5ID0+IHRoaXMuZmluYWxpemUoZW50cnkpKTtcbiAgICBuYW1lRGVzZXJpYWxpemVyTWFwID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0cnVjdG9yU2VyaWFsaXplck1hcCA9IG5ldyBNYXAoKTtcbiAgICB0cmFuc3BvcnRTYWZlQXJndW1lbnRUeXBlcyA9IFJwY1BlZXIuZ2V0RGVmYXVsdFRyYW5zcG9ydFNhZmVBcmd1bWVudFR5cGVzKCk7XG4gICAga2lsbGVkO1xuICAgIGtpbGxlZERlZmVycmVkO1xuICAgIHRhZ3MgPSB7fTtcbiAgICBzdGF0aWMgZmluYWxpemVySWRTeW1ib2wgPSBTeW1ib2woJ3JwY0ZpbmFsaXplcklkJyk7XG4gICAgc3RhdGljIHJlbW90ZXNDb2xsZWN0ZWQgPSAwO1xuICAgIHN0YXRpYyByZW1vdGVzQ3JlYXRlZCA9IDA7XG4gICAgc3RhdGljIGFjdGl2ZVJwY1BlZXI7XG4gICAgc3RhdGljIGlzUnBjUHJveHkodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuICEhdmFsdWU/LltScGNQZWVyLlBST1BFUlRZX1BST1hZX0lEXTtcbiAgICB9XG4gICAgc3RhdGljIGdldERlZmF1bHRUcmFuc3BvcnRTYWZlQXJndW1lbnRUeXBlcygpIHtcbiAgICAgICAgY29uc3QganNvblNlcmlhbGl6YWJsZSA9IG5ldyBTZXQoKTtcbiAgICAgICAganNvblNlcmlhbGl6YWJsZS5hZGQoTnVtYmVyLm5hbWUpO1xuICAgICAgICBqc29uU2VyaWFsaXphYmxlLmFkZChTdHJpbmcubmFtZSk7XG4gICAgICAgIGpzb25TZXJpYWxpemFibGUuYWRkKE9iamVjdC5uYW1lKTtcbiAgICAgICAganNvblNlcmlhbGl6YWJsZS5hZGQoQm9vbGVhbi5uYW1lKTtcbiAgICAgICAganNvblNlcmlhbGl6YWJsZS5hZGQoQXJyYXkubmFtZSk7XG4gICAgICAgIHJldHVybiBqc29uU2VyaWFsaXphYmxlO1xuICAgIH1cbiAgICBzdGF0aWMgaGFuZGxlRnVuY3Rpb25JbnZvY2F0aW9ucyh0aGl6LCB0YXJnZXQsIHAsIHJlY2VpdmVyKSB7XG4gICAgICAgIGlmIChwID09PSAnYXBwbHknKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXNBcmcsIGFyZ3MpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpei5hcHBseSh0YXJnZXQsIHRoaXosIGFyZ3MpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwID09PSAnY2FsbCcpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpc0FyZywgLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGl6LmFwcGx5KHRhcmdldCwgdGhpeiwgYXJncyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHAgPT09ICd0b1N0cmluZycgfHwgcCA9PT0gU3ltYm9sLnRvUHJpbWl0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXNBcmcsIC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpei50b1ByaW1pdGl2ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgUFJPUEVSVFlfUFJPWFlfSUQgPSAnX19wcm94eV9pZCc7XG4gICAgc3RhdGljIFBST1BFUlRZX1BST1hZX09ORVdBWV9NRVRIT0RTID0gJ19fcHJveHlfb25ld2F5X21ldGhvZHMnO1xuICAgIHN0YXRpYyBQUk9QRVJUWV9KU09OX0RJU0FCTEVfU0VSSUFMSVpBVElPTiA9ICdfX2pzb25fZGlzYWJsZV9zZXJpYWxpemF0aW9uJztcbiAgICBzdGF0aWMgUFJPUEVSVFlfUFJPWFlfUFJPUEVSVElFUyA9ICdfX3Byb3h5X3Byb3BzJztcbiAgICBzdGF0aWMgUFJPUEVSVFlfSlNPTl9DT1BZX1NFUklBTElaRV9DSElMRFJFTiA9ICdfX2pzb25fY29weV9zZXJpYWxpemVfY2hpbGRyZW4nO1xuICAgIHN0YXRpYyBQUk9CRURfUFJPUEVSVElFUyA9IG5ldyBTZXQoW1xuICAgICAgICAndGhlbicsXG4gICAgICAgICdjb25zdHJ1Y3RvcicsXG4gICAgICAgICdfX3Byb3h5X2lkJyxcbiAgICAgICAgJ19fcHJveHlfY29uc3RydWN0b3InLFxuICAgICAgICAnX19wcm94eV9wZWVyJyxcbiAgICAgICAgUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9PTkVXQVlfTUVUSE9EUyxcbiAgICAgICAgUnBjUGVlci5QUk9QRVJUWV9KU09OX0RJU0FCTEVfU0VSSUFMSVpBVElPTixcbiAgICAgICAgUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9QUk9QRVJUSUVTLFxuICAgICAgICBScGNQZWVyLlBST1BFUlRZX0pTT05fQ09QWV9TRVJJQUxJWkVfQ0hJTERSRU4sXG4gICAgXSk7XG4gICAgY29uc3RydWN0b3Ioc2VsZk5hbWUsIHBlZXJOYW1lLCBzZW5kKSB7XG4gICAgICAgIHRoaXMuc2VsZk5hbWUgPSBzZWxmTmFtZTtcbiAgICAgICAgdGhpcy5wZWVyTmFtZSA9IHBlZXJOYW1lO1xuICAgICAgICB0aGlzLnNlbmQgPSBzZW5kO1xuICAgICAgICB0aGlzLmtpbGxlZCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMua2lsbGVkRGVmZXJyZWQgPSB7IHJlc29sdmUsIHJlamVjdCB9O1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5raWxsZWQuY2F0Y2goKCkgPT4geyB9KTtcbiAgICB9XG4gICAgY3JlYXRlUGVuZGluZ1Jlc3VsdChjYikge1xuICAgICAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHRoaXMucGVuZGluZ1Jlc3VsdHMpKVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBSUENSZXN1bHRFcnJvcih0aGlzLCAnUnBjUGVlciBoYXMgYmVlbiBraWxsZWQnKSk7XG4gICAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpZCA9ICh0aGlzLmlkQ291bnRlcisrKS50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5wZW5kaW5nUmVzdWx0c1tpZF0gPSB7IHJlc29sdmUsIHJlamVjdCB9O1xuICAgICAgICAgICAgY2IoaWQsIGUgPT4gcmVqZWN0KG5ldyBSUENSZXN1bHRFcnJvcih0aGlzLCBlLm1lc3NhZ2UsIGUpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyB0b2RvOiBtYWtlIHRoaXMgYW4gb3B0aW9uIHNvIHJwYyBkb2Vzbid0IG51a2UgdGhlIHByb2Nlc3MgaWYgdW5jYXVnaHQ/XG4gICAgICAgIHByb21pc2UuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIGtpbGwobWVzc2FnZSkge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBSUENSZXN1bHRFcnJvcih0aGlzLCBtZXNzYWdlIHx8ICdwZWVyIHdhcyBraWxsZWQnKTtcbiAgICAgICAgdGhpcy5raWxsZWREZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiBPYmplY3QudmFsdWVzKHRoaXMucGVuZGluZ1Jlc3VsdHMpKSB7XG4gICAgICAgICAgICByZXN1bHQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBlbmRpbmdSZXN1bHRzID0gT2JqZWN0LmZyZWV6ZSh7fSk7XG4gICAgICAgIHRoaXMucGFyYW1zID0gT2JqZWN0LmZyZWV6ZSh7fSk7XG4gICAgICAgIHRoaXMucmVtb3RlV2Vha1Byb3hpZXMgPSBPYmplY3QuZnJlZXplKHt9KTtcbiAgICAgICAgdGhpcy5sb2NhbFByb3h5TWFwID0gT2JqZWN0LmZyZWV6ZSh7fSk7XG4gICAgICAgIHRoaXMubG9jYWxQcm94aWVkLmNsZWFyKCk7XG4gICAgfVxuICAgIC8vIG5lZWQgYSBuYW1lL2NvbnN0cnVjdG9yIG1hcCBkdWUgdG8gYmFiZWwgbmFtZSBtYW5nbGluZz8gZml4IHNvbWVob3c/XG4gICAgYWRkU2VyaWFsaXplcihjdHIsIG5hbWUsIHNlcmlhbGl6ZXIpIHtcbiAgICAgICAgdGhpcy5uYW1lRGVzZXJpYWxpemVyTWFwLnNldChuYW1lLCBzZXJpYWxpemVyKTtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvclNlcmlhbGl6ZXJNYXAuc2V0KGN0ciwgbmFtZSk7XG4gICAgfVxuICAgIGZpbmFsaXplKGVudHJ5KSB7XG4gICAgICAgIFJwY1BlZXIucmVtb3Rlc0NvbGxlY3RlZCsrO1xuICAgICAgICBkZWxldGUgdGhpcy5yZW1vdGVXZWFrUHJveGllc1tlbnRyeS5pZF07XG4gICAgICAgIGNvbnN0IHJwY0ZpbmFsaXplID0ge1xuICAgICAgICAgICAgX19sb2NhbF9wcm94eV9pZDogZW50cnkuaWQsXG4gICAgICAgICAgICBfX2xvY2FsX3Byb3h5X2ZpbmFsaXplcl9pZDogZW50cnkuZmluYWxpemVySWQsXG4gICAgICAgICAgICB0eXBlOiAnZmluYWxpemUnLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNlbmQocnBjRmluYWxpemUpO1xuICAgIH1cbiAgICBhc3luYyBnZXRQYXJhbShwYXJhbSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVQZW5kaW5nUmVzdWx0KChpZCwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbU1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3BhcmFtJyxcbiAgICAgICAgICAgICAgICBwYXJhbSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNlbmQocGFyYW1NZXNzYWdlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZXZhbExvY2FsKHNjcmlwdCwgZmlsZW5hbWUsIGNvZXJjZWRQYXJhbXMpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wYXJhbXMsIGNvZXJjZWRQYXJhbXMpO1xuICAgICAgICBsZXQgY29tcGlsZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIHByZXZlbnQgYnVuZGxlcnMgZnJvbSB0cnlpbmcgdG8gaW5jbHVkZSBub24tZXhpc3RlbnQgdm0gbW9kdWxlLlxuICAgICAgICAgICAgY29tcGlsZSA9IG1vZHVsZVtgcmVxdWlyZWBdKCd2bScpLmNvbXBpbGVGdW5jdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29tcGlsZSA9IGNvbXBpbGVGdW5jdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmID0gY29tcGlsZShzY3JpcHQsIE9iamVjdC5rZXlzKHBhcmFtcyksIHtcbiAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBmKC4uLk9iamVjdC52YWx1ZXMocGFyYW1zKSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY3JlYXRlRXJyb3JSZXN1bHQocmVzdWx0LCBlKSB7XG4gICAgICAgIHJlc3VsdC5zdGFjayA9IGUuc3RhY2sgfHwgJ25vIHN0YWNrJztcbiAgICAgICAgcmVzdWx0LnJlc3VsdCA9IGUubmFtZSB8fCAnbm8gbmFtZSc7XG4gICAgICAgIHJlc3VsdC5tZXNzYWdlID0gZS5tZXNzYWdlIHx8ICdubyBtZXNzYWdlJztcbiAgICB9XG4gICAgZGVzZXJpYWxpemUodmFsdWUsIGRlc2VyaWFsaXphdGlvbkNvbnRleHQpIHtcbiAgICAgICAgaWYgKCF2YWx1ZSlcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgY29uc3QgY29weVNlcmlhbGl6ZUNoaWxkcmVuID0gdmFsdWVbUnBjUGVlci5QUk9QRVJUWV9KU09OX0NPUFlfU0VSSUFMSVpFX0NISUxEUkVOXTtcbiAgICAgICAgaWYgKGNvcHlTZXJpYWxpemVDaGlsZHJlbikge1xuICAgICAgICAgICAgY29uc3QgcmV0ID0ge307XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbF0gb2YgT2JqZWN0LmVudHJpZXModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0W2tleV0gPSB0aGlzLmRlc2VyaWFsaXplKHZhbCwgZGVzZXJpYWxpemF0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgX19yZW1vdGVfcHJveHlfaWQsIF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZCwgX19sb2NhbF9wcm94eV9pZCwgX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSwgX19zZXJpYWxpemVkX3ZhbHVlLCBfX3JlbW90ZV9wcm94eV9wcm9wcywgX19yZW1vdGVfcHJveHlfb25ld2F5X21ldGhvZHMgfSA9IHZhbHVlO1xuICAgICAgICBpZiAoX19yZW1vdGVfcHJveHlfaWQpIHtcbiAgICAgICAgICAgIGxldCBwcm94eSA9IHRoaXMucmVtb3RlV2Vha1Byb3hpZXNbX19yZW1vdGVfcHJveHlfaWRdPy5kZXJlZigpO1xuICAgICAgICAgICAgaWYgKCFwcm94eSlcbiAgICAgICAgICAgICAgICBwcm94eSA9IHRoaXMubmV3UHJveHkoX19yZW1vdGVfcHJveHlfaWQsIF9fcmVtb3RlX2NvbnN0cnVjdG9yX25hbWUsIF9fcmVtb3RlX3Byb3h5X3Byb3BzLCBfX3JlbW90ZV9wcm94eV9vbmV3YXlfbWV0aG9kcyk7XG4gICAgICAgICAgICBwcm94eVtScGNQZWVyLmZpbmFsaXplcklkU3ltYm9sXSA9IF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZDtcbiAgICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplciA9IHRoaXMubmFtZURlc2VyaWFsaXplck1hcC5nZXQoX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSk7XG4gICAgICAgICAgICBpZiAoZGVzZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShwcm94eSwgZGVzZXJpYWxpemF0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcHJveHk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF9fbG9jYWxfcHJveHlfaWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJldCA9IHRoaXMubG9jYWxQcm94eU1hcFtfX2xvY2FsX3Byb3h5X2lkXTtcbiAgICAgICAgICAgIGlmICghcmV0KVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSUENSZXN1bHRFcnJvcih0aGlzLCBgaW52YWxpZCBsb2NhbCBwcm94eSBpZCAke19fbG9jYWxfcHJveHlfaWR9YCk7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlc2VyaWFsaXplciA9IHRoaXMubmFtZURlc2VyaWFsaXplck1hcC5nZXQoX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSk7XG4gICAgICAgIGlmIChkZXNlcmlhbGl6ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoX19zZXJpYWxpemVkX3ZhbHVlLCBkZXNlcmlhbGl6YXRpb25Db250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwgc2VyaWFsaXphdGlvbkNvbnRleHQpIHtcbiAgICAgICAgaWYgKHZhbHVlPy5bUnBjUGVlci5QUk9QRVJUWV9KU09OX0NPUFlfU0VSSUFMSVpFX0NISUxEUkVOXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgY29uc3QgcmV0ID0ge307XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbF0gb2YgT2JqZWN0LmVudHJpZXModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0W2tleV0gPSB0aGlzLnNlcmlhbGl6ZSh2YWwsIHNlcmlhbGl6YXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZSB8fCAoIXZhbHVlW1JwY1BlZXIuUFJPUEVSVFlfSlNPTl9ESVNBQkxFX1NFUklBTElaQVRJT05dICYmIHRoaXMudHJhbnNwb3J0U2FmZUFyZ3VtZW50VHlwZXMuaGFzKHZhbHVlLmNvbnN0cnVjdG9yPy5uYW1lKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSA9IHZhbHVlLl9fcHJveHlfY29uc3RydWN0b3IgfHwgdmFsdWUuY29uc3RydWN0b3I/Lm5hbWU/LnRvU3RyaW5nKCk7XG4gICAgICAgIGxldCBwcm94aWVkRW50cnkgPSB0aGlzLmxvY2FsUHJveGllZC5nZXQodmFsdWUpO1xuICAgICAgICBpZiAocHJveGllZEVudHJ5KSB7XG4gICAgICAgICAgICBjb25zdCBfX3JlbW90ZV9wcm94eV9maW5hbGl6ZXJfaWQgPSAodGhpcy5wcm94eUNvdW50ZXIrKykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHByb3hpZWRFbnRyeS5maW5hbGl6ZXJJZCA9IF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZDtcbiAgICAgICAgICAgIGNvbnN0IHJldCA9IHtcbiAgICAgICAgICAgICAgICBfX3JlbW90ZV9wcm94eV9pZDogcHJveGllZEVudHJ5LmlkLFxuICAgICAgICAgICAgICAgIF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZCxcbiAgICAgICAgICAgICAgICBfX3JlbW90ZV9jb25zdHJ1Y3Rvcl9uYW1lLFxuICAgICAgICAgICAgICAgIF9fcmVtb3RlX3Byb3h5X3Byb3BzOiB2YWx1ZT8uW1JwY1BlZXIuUFJPUEVSVFlfUFJPWFlfUFJPUEVSVElFU10sXG4gICAgICAgICAgICAgICAgX19yZW1vdGVfcHJveHlfb25ld2F5X21ldGhvZHM6IHZhbHVlPy5bUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9PTkVXQVlfTUVUSE9EU10sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IF9fcHJveHlfaWQsIF9fcHJveHlfcGVlciB9ID0gdmFsdWU7XG4gICAgICAgIGlmIChfX3Byb3h5X2lkICYmIF9fcHJveHlfcGVlciA9PT0gdGhpcykge1xuICAgICAgICAgICAgY29uc3QgcmV0ID0ge1xuICAgICAgICAgICAgICAgIF9fbG9jYWxfcHJveHlfaWQ6IF9fcHJveHlfaWQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzZXJpYWxpemVyTWFwTmFtZSA9IHRoaXMuY29uc3RydWN0b3JTZXJpYWxpemVyTWFwLmdldCh2YWx1ZS5jb25zdHJ1Y3Rvcik7XG4gICAgICAgIGlmIChzZXJpYWxpemVyTWFwTmFtZSkge1xuICAgICAgICAgICAgX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSA9IHNlcmlhbGl6ZXJNYXBOYW1lO1xuICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplciA9IHRoaXMubmFtZURlc2VyaWFsaXplck1hcC5nZXQoc2VyaWFsaXplck1hcE5hbWUpO1xuICAgICAgICAgICAgaWYgKCFzZXJpYWxpemVyKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2VyaWFsaXplciBub3QgZm91bmQgZm9yICcgKyBzZXJpYWxpemVyTWFwTmFtZSk7XG4gICAgICAgICAgICBjb25zdCBzZXJpYWxpemVkID0gc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUsIHNlcmlhbGl6YXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIGNvbnN0IHJldCA9IHtcbiAgICAgICAgICAgICAgICBfX3JlbW90ZV9wcm94eV9pZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIF9fcmVtb3RlX2NvbnN0cnVjdG9yX25hbWUsXG4gICAgICAgICAgICAgICAgX19yZW1vdGVfcHJveHlfcHJvcHM6IHZhbHVlPy5bUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9QUk9QRVJUSUVTXSxcbiAgICAgICAgICAgICAgICBfX3JlbW90ZV9wcm94eV9vbmV3YXlfbWV0aG9kczogdmFsdWU/LltScGNQZWVyLlBST1BFUlRZX1BST1hZX09ORVdBWV9NRVRIT0RTXSxcbiAgICAgICAgICAgICAgICBfX3NlcmlhbGl6ZWRfdmFsdWU6IHNlcmlhbGl6ZWQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBfX3JlbW90ZV9wcm94eV9pZCA9ICh0aGlzLnByb3h5Q291bnRlcisrKS50b1N0cmluZygpO1xuICAgICAgICBwcm94aWVkRW50cnkgPSB7XG4gICAgICAgICAgICBpZDogX19yZW1vdGVfcHJveHlfaWQsXG4gICAgICAgICAgICBmaW5hbGl6ZXJJZDogX19yZW1vdGVfcHJveHlfaWQsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubG9jYWxQcm94aWVkLnNldCh2YWx1ZSwgcHJveGllZEVudHJ5KTtcbiAgICAgICAgdGhpcy5sb2NhbFByb3h5TWFwW19fcmVtb3RlX3Byb3h5X2lkXSA9IHZhbHVlO1xuICAgICAgICBjb25zdCByZXQgPSB7XG4gICAgICAgICAgICBfX3JlbW90ZV9wcm94eV9pZCxcbiAgICAgICAgICAgIF9fcmVtb3RlX3Byb3h5X2ZpbmFsaXplcl9pZDogX19yZW1vdGVfcHJveHlfaWQsXG4gICAgICAgICAgICBfX3JlbW90ZV9jb25zdHJ1Y3Rvcl9uYW1lLFxuICAgICAgICAgICAgX19yZW1vdGVfcHJveHlfcHJvcHM6IHZhbHVlPy5bUnBjUGVlci5QUk9QRVJUWV9QUk9YWV9QUk9QRVJUSUVTXSxcbiAgICAgICAgICAgIF9fcmVtb3RlX3Byb3h5X29uZXdheV9tZXRob2RzOiB2YWx1ZT8uW1JwY1BlZXIuUFJPUEVSVFlfUFJPWFlfT05FV0FZX01FVEhPRFNdLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICBuZXdQcm94eShwcm94eUlkLCBwcm94eUNvbnN0cnVjdG9yTmFtZSwgcHJveHlQcm9wcywgcHJveHlPbmVXYXlNZXRob2RzKSB7XG4gICAgICAgIFJwY1BlZXIucmVtb3Rlc0NyZWF0ZWQrKztcbiAgICAgICAgY29uc3QgbG9jYWxQcm94aWVkRW50cnkgPSB7XG4gICAgICAgICAgICBpZDogcHJveHlJZCxcbiAgICAgICAgICAgIGZpbmFsaXplcklkOiB1bmRlZmluZWQsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJwYyA9IG5ldyBScGNQcm94eSh0aGlzLCBsb2NhbFByb3hpZWRFbnRyeSwgcHJveHlDb25zdHJ1Y3Rvck5hbWUsIHByb3h5UHJvcHMsIHByb3h5T25lV2F5TWV0aG9kcyk7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHByb3h5Q29uc3RydWN0b3JOYW1lID09PSAnRnVuY3Rpb24nIHx8IHByb3h5Q29uc3RydWN0b3JOYW1lID09PSAnQXN5bmNGdW5jdGlvbicgPyBmdW5jdGlvbiAoKSB7IH0gOiBycGM7XG4gICAgICAgIGNvbnN0IHByb3h5ID0gbmV3IFByb3h5KHRhcmdldCwgcnBjKTtcbiAgICAgICAgY29uc3Qgd2Vha3JlZiA9IG5ldyBXZWFrUmVmKHByb3h5KTtcbiAgICAgICAgdGhpcy5yZW1vdGVXZWFrUHJveGllc1twcm94eUlkXSA9IHdlYWtyZWY7XG4gICAgICAgIHRoaXMuZmluYWxpemVycy5yZWdpc3RlcihycGMsIGxvY2FsUHJveGllZEVudHJ5KTtcbiAgICAgICAgcmV0dXJuIHByb3h5O1xuICAgIH1cbiAgICBoYW5kbGVNZXNzYWdlKG1lc3NhZ2UsIGRlc2VyaWFsaXphdGlvbkNvbnRleHQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIFJwY1BlZXIuYWN0aXZlUnBjUGVlciA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZU1lc3NhZ2VJbnRlcm5hbChtZXNzYWdlLCBkZXNlcmlhbGl6YXRpb25Db250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIFJwY1BlZXIuYWN0aXZlUnBjUGVlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBoYW5kbGVNZXNzYWdlSW50ZXJuYWwobWVzc2FnZSwgZGVzZXJpYWxpemF0aW9uQ29udGV4dCkge1xuICAgICAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHRoaXMucGVuZGluZ1Jlc3VsdHMpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3dpdGNoIChtZXNzYWdlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhbSc6IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcnBjUGFyYW0gPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXJpYWxpemF0aW9uQ29udGV4dCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVzdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBycGNQYXJhbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogdGhpcy5zZXJpYWxpemUodGhpcy5wYXJhbXNbcnBjUGFyYW0ucGFyYW1dLCBzZXJpYWxpemF0aW9uQ29udGV4dClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZW5kKHJlc3VsdCwgdW5kZWZpbmVkLCBzZXJpYWxpemF0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlICdhcHBseSc6IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcnBjQXBwbHkgPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVzdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBycGNBcHBseS5pZCB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXphdGlvbkNvbnRleHQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMubG9jYWxQcm94eU1hcFtycGNBcHBseS5wcm94eUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgcHJveHkgaWQgJHtycGNBcHBseS5wcm94eUlkfSBub3QgZm91bmRgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYXJnIG9mIChycGNBcHBseS5hcmdzIHx8IFtdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh0aGlzLmRlc2VyaWFsaXplKGFyZywgZGVzZXJpYWxpemF0aW9uQ29udGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJwY0FwcGx5Lm1ldGhvZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1ldGhvZCA9IHRhcmdldFtycGNBcHBseS5tZXRob2RdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWV0aG9kKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHRhcmdldCAke3RhcmdldD8uY29uc3RydWN0b3I/Lm5hbWV9IGRvZXMgbm90IGhhdmUgbWV0aG9kICR7cnBjQXBwbHkubWV0aG9kfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYXdhaXQgdGFyZ2V0W3JwY0FwcGx5Lm1ldGhvZF0oLi4uYXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGF3YWl0IHRhcmdldCguLi5hcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5yZXN1bHQgPSB0aGlzLnNlcmlhbGl6ZSh2YWx1ZSwgc2VyaWFsaXphdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmVycm9yKCdmYWlsdXJlJywgcnBjQXBwbHkubWV0aG9kLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRXJyb3JSZXN1bHQocmVzdWx0LCBlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJwY0FwcGx5Lm9uZXdheSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZChyZXN1bHQsIHVuZGVmaW5lZCwgc2VyaWFsaXphdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSAncmVzdWx0Jzoge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBycGNSZXN1bHQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWZlcnJlZCA9IHRoaXMucGVuZGluZ1Jlc3VsdHNbcnBjUmVzdWx0LmlkXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucGVuZGluZ1Jlc3VsdHNbcnBjUmVzdWx0LmlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkZWZlcnJlZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgdW5rbm93biByZXN1bHQgJHtycGNSZXN1bHQuaWR9YCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChycGNSZXN1bHQubWVzc2FnZSB8fCBycGNSZXN1bHQuc3RhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgUlBDUmVzdWx0RXJyb3IodGhpcywgcnBjUmVzdWx0Lm1lc3NhZ2UgfHwgJ25vIG1lc3NhZ2UnLCB1bmRlZmluZWQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBycGNSZXN1bHQucmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrOiBycGNSZXN1bHQuc3RhY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHRoaXMuZGVzZXJpYWxpemUocnBjUmVzdWx0LnJlc3VsdCwgZGVzZXJpYWxpemF0aW9uQ29udGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSAnZmluYWxpemUnOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJwY0ZpbmFsaXplID0gbWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9jYWwgPSB0aGlzLmxvY2FsUHJveHlNYXBbcnBjRmluYWxpemUuX19sb2NhbF9wcm94eV9pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9jYWxQcm94aWVkRW50cnkgPSB0aGlzLmxvY2FsUHJveGllZC5nZXQobG9jYWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgYSBmaW5hbGl6ZXIgaWQgaXMgc3BlY2lmaWVkLCBpdCBtdXN0IG1hdGNoLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJwY0ZpbmFsaXplLl9fbG9jYWxfcHJveHlfZmluYWxpemVyX2lkICYmIHJwY0ZpbmFsaXplLl9fbG9jYWxfcHJveHlfZmluYWxpemVyX2lkICE9PSBsb2NhbFByb3hpZWRFbnRyeT8uZmluYWxpemVySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxvY2FsUHJveHlNYXBbcnBjRmluYWxpemUuX19sb2NhbF9wcm94eV9pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsUHJveGllZC5kZWxldGUobG9jYWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gcnBjIG1lc3NhZ2UgdHlwZSAke21lc3NhZ2UudHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcigndW5oYW5kbGVkIHJwYyBlcnJvcicsIHRoaXMucGVlck5hbWUsIGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEV2YWxTb3VyY2UoKSB7XG4gICAgcmV0dXJuIGBcbiAgICAoKCkgPT4ge1xuICAgICAgICAke1JwY1Byb3h5fVxuXG4gICAgICAgICR7UnBjUGVlcn1cbiAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFJwY1BlZXIsXG4gICAgICAgICAgICBScGNQcm94eSxcbiAgICAgICAgfTtcbiAgICB9KSgpO1xuICAgIGA7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ycGMuanMubWFwIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHRpZDogbW9kdWxlSWQsXG5cdFx0bG9hZGVkOiBmYWxzZSxcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG5cdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmhtZCA9IChtb2R1bGUpID0+IHtcblx0bW9kdWxlID0gT2JqZWN0LmNyZWF0ZShtb2R1bGUpO1xuXHRpZiAoIW1vZHVsZS5jaGlsZHJlbikgbW9kdWxlLmNoaWxkcmVuID0gW107XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsICdleHBvcnRzJywge1xuXHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0c2V0OiAoKSA9PiB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0VTIE1vZHVsZXMgbWF5IG5vdCBhc3NpZ24gbW9kdWxlLmV4cG9ydHMgb3IgZXhwb3J0cy4qLCBVc2UgRVNNIGV4cG9ydCBzeW50YXgsIGluc3RlYWQ6ICcgKyBtb2R1bGUuaWQpO1xuXHRcdH1cblx0fSk7XG5cdHJldHVybiBtb2R1bGU7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJleHBvcnQgY2xhc3MgRGVmZXJyZWQge1xuICAgIGZpbmlzaGVkID0gZmFsc2U7XG4gICAgcmVzb2x2ZTtcbiAgICByZWplY3Q7XG4gICAgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgdGhpcy5yZXNvbHZlID0gdiA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc29sdmUodik7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVqZWN0ID0gZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZmVycmVkLmpzLm1hcCIsImltcG9ydCB7IERlZmVycmVkIH0gZnJvbSBcIi4vZGVmZXJyZWRcIjtcbmZ1bmN0aW9uIGdldFVzZXJBZ2VudCgpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICB9XG59XG4vLyBjb25uZWN0aW9uU3RhdGUgaXMgbm90IGltcGxlbWVudGVkIGluIGZpcmVmb3g/IHNvIHdhdGNoIGljZUNvbm5lY3Rpb25TdGF0ZSBpbnN0ZWFkLi4uXG5leHBvcnQgZnVuY3Rpb24gd2FpdFBlZXJDb25uZWN0aW9uSWNlQ29ubmVjdGVkKHBjKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgaWYgKHBjLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcpIHtcbiAgICAgICAgICAgIHJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBwYy5hZGRFdmVudExpc3RlbmVyKCdpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAocGMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnY29ubmVjdGVkJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB3YWl0UGVlckljZUNvbm5lY3Rpb25DbG9zZWQocGMpLnRoZW4ocmVhc29uID0+IHJlamVjdChuZXcgRXJyb3IocmVhc29uKSkpO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHdhaXRQZWVySWNlQ29ubmVjdGlvbkNsb3NlZChwYykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgcGMuYWRkRXZlbnRMaXN0ZW5lcignaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzUGVlckNvbm5lY3Rpb25DbG9zZWQocGMpKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShwYy5pY2VDb25uZWN0aW9uU3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1BlZXJDb25uZWN0aW9uQ2xvc2VkKHBjKSB7XG4gICAgcmV0dXJuIHBjLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2Rpc2Nvbm5lY3RlZCdcbiAgICAgICAgfHwgcGMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnZmFpbGVkJ1xuICAgICAgICB8fCBwYy5pY2VDb25uZWN0aW9uU3RhdGUgPT09ICdjbG9zZWQnO1xufVxuZnVuY3Rpb24gc2lsZW5jZSgpIHtcbiAgICBsZXQgY3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpLCBvc2NpbGxhdG9yID0gY3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTtcbiAgICBjb25zdCBkZXN0ID0gY3R4LmNyZWF0ZU1lZGlhU3RyZWFtRGVzdGluYXRpb24oKTtcbiAgICBvc2NpbGxhdG9yLmNvbm5lY3QoZGVzdCk7XG4gICAgb3NjaWxsYXRvci5zdGFydCgpO1xuICAgIGNvbnN0IHJldCA9IGRlc3Quc3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG4gICAgcmV0LmVuYWJsZWQgPSBmYWxzZTtcbiAgICByZXR1cm4gcmV0O1xufVxuZXhwb3J0IGNsYXNzIEJyb3dzZXJTaWduYWxpbmdTZXNzaW9uIHtcbiAgICBwYztcbiAgICBwY0RlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgZGNEZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIG1pY3JvcGhvbmU7XG4gICAgbWljRW5hYmxlZCA9IGZhbHNlO1xuICAgIG9uUGVlckNvbm5lY3Rpb247XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgICAgdXNlckFnZW50OiBnZXRVc2VyQWdlbnQoKSxcbiAgICAgICAgY2FwYWJpbGl0aWVzOiB7XG4gICAgICAgICAgICBhdWRpbzogUlRDUnRwUmVjZWl2ZXIuZ2V0Q2FwYWJpbGl0aWVzPy4oJ2F1ZGlvJykgfHwge1xuICAgICAgICAgICAgICAgIGNvZGVjczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGhlYWRlckV4dGVuc2lvbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB2aWRlbzogUlRDUnRwUmVjZWl2ZXIuZ2V0Q2FwYWJpbGl0aWVzPy4oJ3ZpZGVvJykgfHwge1xuICAgICAgICAgICAgICAgIGNvZGVjczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGhlYWRlckV4dGVuc2lvbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHNjcmVlbjoge1xuICAgICAgICAgICAgZGV2aWNlUGl4ZWxSYXRpbzogd2luZG93LmRldmljZVBpeGVsUmF0aW8sXG4gICAgICAgICAgICB3aWR0aDogc2NyZWVuLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBzY3JlZW4uaGVpZ2h0LFxuICAgICAgICB9LFxuICAgIH07XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgfVxuICAgIGFzeW5jIGdldE9wdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnM7XG4gICAgfVxuICAgIGFzeW5jIHNldE1pY3JvcGhvbmUoZW5hYmxlZCkge1xuICAgICAgICBpZiAodGhpcy5taWNyb3Bob25lICYmIGVuYWJsZWQgJiYgIXRoaXMubWljRW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5taWNFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIGRvaW5nIHNlbmRyZWN2IG9uIHNhZmFyaSByZXF1aXJlcyBhIG1pYyBiZSBhdHRhY2hlZCwgb3IgaXQgZmFpbHMgdG8gY29ubmVjdC5cbiAgICAgICAgICAgIGNvbnN0IG1pYyA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsgdmlkZW86IGZhbHNlLCBhdWRpbzogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubWljcm9waG9uZS5yZXBsYWNlVHJhY2sobWljLmdldFRyYWNrcygpWzBdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1pY3JvcGhvbmUudHJhY2suZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLnBjRGVmZXJyZWQucHJvbWlzZS50aGVuKHBjID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBwYy5nZXRUcmFuc2NlaXZlcnMoKSB8fCBbXSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHQuc2VuZGVyPy50cmFjaz8uc3RvcD8uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICB0aGlzLnBjRGVmZXJyZWQucmVqZWN0KG5ldyBFcnJvcignaWNlQ29ubmVjdGlvblN0YXRlICcgKyB0aGlzLnBjPy5pY2VDb25uZWN0aW9uU3RhdGUpKTtcbiAgICB9XG4gICAgYXN5bmMgY3JlYXRlUGVlckNvbm5lY3Rpb24oc2V0dXApIHtcbiAgICAgICAgaWYgKHRoaXMucGMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IGNoZWNrQ29ubiA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpY2VDb25uZWN0aW9uU3RhdGUnLCBwYy5pY2VDb25uZWN0aW9uU3RhdGUpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3Rpb25TdGF0ZScsIHBjLmNvbm5lY3Rpb25TdGF0ZSk7XG4gICAgICAgICAgICBpZiAoaXNQZWVyQ29ubmVjdGlvbkNsb3NlZChwYykpXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBwYyA9IHRoaXMucGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24oc2V0dXAuY29uZmlndXJhdGlvbik7XG4gICAgICAgIHRoaXMucGNEZWZlcnJlZC5yZXNvbHZlKHBjKTtcbiAgICAgICAgYXdhaXQgdGhpcy5vblBlZXJDb25uZWN0aW9uPy4ocGMpO1xuICAgICAgICAvLyBwYy5hZGRFdmVudExpc3RlbmVyKCdjb25uZWN0aW9uc3RhdGVjaGFuZ2UnLCBjaGVja0Nvbm4pO1xuICAgICAgICBwYy5hZGRFdmVudExpc3RlbmVyKCdpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UnLCBjaGVja0Nvbm4pO1xuICAgICAgICAvLyBwYy5hZGRFdmVudExpc3RlbmVyKCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScsIGV2ID0+IGNvbnNvbGUubG9nKCdpY2VHYXRoZXJpbmdTdGF0ZScsIHBjLmljZUdhdGhlcmluZ1N0YXRlKSlcbiAgICAgICAgLy8gcGMuYWRkRXZlbnRMaXN0ZW5lcignc2lnbmFsaW5nc3RhdGVjaGFuZ2UnLCBldiA9PiBjb25zb2xlLmxvZygnc2lnbmFsaW5nU3RhdGUnLCBwYy5zaWduYWxpbmdTdGF0ZSkpXG4gICAgICAgIC8vIHBjLmFkZEV2ZW50TGlzdGVuZXIoJ2ljZWNhbmRpZGF0ZWVycm9yJywgZXYgPT4gY29uc29sZS5sb2coJ2ljZWNhbmRpZGF0ZWVycm9yJykpXG4gICAgICAgIGlmIChzZXR1cC5kYXRhY2hhbm5lbCkge1xuICAgICAgICAgICAgY29uc3QgZGMgPSBwYy5jcmVhdGVEYXRhQ2hhbm5lbChzZXR1cC5kYXRhY2hhbm5lbC5sYWJlbCwgc2V0dXAuZGF0YWNoYW5uZWwuZGljdCk7XG4gICAgICAgICAgICBkYy5iaW5hcnlUeXBlID0gJ2FycmF5YnVmZmVyJztcbiAgICAgICAgICAgIHRoaXMuZGNEZWZlcnJlZC5yZXNvbHZlKGRjKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2V0dXAuYXVkaW8pIHtcbiAgICAgICAgICAgIGxldCBhdWRpbztcbiAgICAgICAgICAgIGlmIChzZXR1cC5nZXRVc2VyTWVkaWFTYWZhcmlIYWNrICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5jbHVkZXMoJ1NhZmFyaScpICYmICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSkge1xuICAgICAgICAgICAgICAgIC8vIG9mZmVyaW5nIGEgc2VuZHJlY3Ygb24gc2FmYXJpIHJlcXVpcmVzIGEgbWljIGJlIGF0dGFjaGVkIGZvciByaW5nIHdlYnJ0Yywgb3IgaXQgZmFpbHMgdG8gc3RyZWFtP1xuICAgICAgICAgICAgICAgIC8vIGV2ZW4gaWYgYSBzaWxlbnQgdHJhY2sgaXMgdXNlZC4uLlxuICAgICAgICAgICAgICAgIGF1ZGlvID0gcGMuYWRkVHJhbnNjZWl2ZXIoJ2F1ZGlvJywge1xuICAgICAgICAgICAgICAgICAgICAuLi5zZXR1cC5hdWRpbyxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyBhdWRpbzogdHJ1ZSB9KVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXVkaW8gPSBwYy5hZGRUcmFuc2NlaXZlcignYXVkaW8nLCBzZXR1cC5hdWRpbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2V0dXAuYXVkaW8uZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IHNldHVwLmF1ZGlvLmRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jykge1xuICAgICAgICAgICAgICAgIHRoaXMubWljcm9waG9uZSA9IGF1ZGlvLnNlbmRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2V0dXAudmlkZW8pIHtcbiAgICAgICAgICAgIGlmIChzZXR1cC52aWRlby5kaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgc2V0dXAudmlkZW8uZGlyZWN0aW9uID09PSAnc2VuZG9ubHknKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FtZXJhID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyB2aWRlbzogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0cmFjayBvZiBjYW1lcmEuZ2V0VHJhY2tzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBjLmFkZFRyYWNrKHRyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB3aGF0IG5vd1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBjLmFkZFRyYW5zY2VpdmVyKCd2aWRlbycsIHNldHVwLnZpZGVvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBjcmVhdGVMb2NhbERlc2NyaXB0aW9uKHR5cGUsIHNldHVwLCBzZW5kSWNlQ2FuZGlkYXRlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlUGVlckNvbm5lY3Rpb24oc2V0dXApO1xuICAgICAgICBjb25zdCBnYXRoZXJpbmdQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBjLm9uaWNlY2FuZGlkYXRlID0gZXYgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldi5jYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJsb2NhbCBjYW5kaWRhdGVcIiwgZXYuY2FuZGlkYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgc2VuZEljZUNhbmRpZGF0ZT8uKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZXYuY2FuZGlkYXRlKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnBjLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGMuaWNlR2F0aGVyaW5nU3RhdGUgPT09ICdjb21wbGV0ZScpXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB0b0Rlc2NyaXB0aW9uID0gKGluaXQpID0+IHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdsb2NhbCBkZXNjcmlwdGlvbicsIGluaXQuc2RwKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogaW5pdC50eXBlLFxuICAgICAgICAgICAgICAgIHNkcDogaW5pdC5zZHAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBpZiAodHlwZSA9PT0gJ29mZmVyJykge1xuICAgICAgICAgICAgbGV0IG9mZmVyID0gYXdhaXQgdGhpcy5wYy5jcmVhdGVPZmZlcih7XG4gICAgICAgICAgICAgICAgb2ZmZXJUb1JlY2VpdmVBdWRpbzogISFzZXR1cC5hdWRpbyxcbiAgICAgICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiAhIXNldHVwLnZpZGVvLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBzZXQgPSB0aGlzLnBjLnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXIpO1xuICAgICAgICAgICAgaWYgKHNlbmRJY2VDYW5kaWRhdGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvRGVzY3JpcHRpb24ob2ZmZXIpO1xuICAgICAgICAgICAgYXdhaXQgc2V0O1xuICAgICAgICAgICAgYXdhaXQgZ2F0aGVyaW5nUHJvbWlzZTtcbiAgICAgICAgICAgIG9mZmVyID0gYXdhaXQgdGhpcy5wYy5jcmVhdGVPZmZlcih7XG4gICAgICAgICAgICAgICAgb2ZmZXJUb1JlY2VpdmVBdWRpbzogISFzZXR1cC5hdWRpbyxcbiAgICAgICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiAhIXNldHVwLnZpZGVvLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdG9EZXNjcmlwdGlvbihvZmZlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXQgYW5zd2VyID0gYXdhaXQgdGhpcy5wYy5jcmVhdGVBbnN3ZXIoKTtcbiAgICAgICAgICAgIGNvbnN0IHNldCA9IHRoaXMucGMuc2V0TG9jYWxEZXNjcmlwdGlvbihhbnN3ZXIpO1xuICAgICAgICAgICAgaWYgKHNlbmRJY2VDYW5kaWRhdGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvRGVzY3JpcHRpb24oYW5zd2VyKTtcbiAgICAgICAgICAgIGF3YWl0IHNldDtcbiAgICAgICAgICAgIGF3YWl0IGdhdGhlcmluZ1Byb21pc2U7XG4gICAgICAgICAgICBhbnN3ZXIgPSB0aGlzLnBjLmN1cnJlbnRMb2NhbERlc2NyaXB0aW9uIHx8IGFuc3dlcjtcbiAgICAgICAgICAgIHJldHVybiB0b0Rlc2NyaXB0aW9uKGFuc3dlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc2V0UmVtb3RlRGVzY3JpcHRpb24oZGVzY3JpcHRpb24sIHNldHVwKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlUGVlckNvbm5lY3Rpb24oc2V0dXApO1xuICAgICAgICBhd2FpdCB0aGlzLnBjLnNldFJlbW90ZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3JlbW90ZSBkZXNjcmlwdGlvbicsIGRlc2NyaXB0aW9uLnNkcCk7XG4gICAgfVxuICAgIGFzeW5jIGFkZEljZUNhbmRpZGF0ZShjYW5kaWRhdGUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wYy5hZGRJY2VDYW5kaWRhdGUoY2FuZGlkYXRlKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJyZW1vdGUgY2FuZGlkYXRlXCIsIGNhbmRpZGF0ZSk7XG4gICAgfVxuICAgIGFzeW5jIGVuZFNlc3Npb24oKSB7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9nU2VuZENhbmRpZGF0ZShjb25zb2xlLCB0eXBlLCBzZXNzaW9uKSB7XG4gICAgcmV0dXJuIGFzeW5jIChjYW5kaWRhdGUpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3R5cGV9IHRyaWNrbGVkIGNhbmRpZGF0ZTpgLCBjYW5kaWRhdGUuc2RwTUxpbmVJbmRleCwgY2FuZGlkYXRlLmNhbmRpZGF0ZSk7XG4gICAgICAgICAgICBhd2FpdCBzZXNzaW9uLmFkZEljZUNhbmRpZGF0ZShjYW5kaWRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdhZGRJY2VDYW5kaWRhdGUgZXJyb3InLCBlKTtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlQ2FuZGlkYXRlUXVldWUoY29uc29sZSwgdHlwZSwgc2Vzc2lvbikge1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgIGxldCBjYW5kaWRhdGVRdWV1ZSA9IFtdO1xuICAgIGNvbnN0IGxzID0gbG9nU2VuZENhbmRpZGF0ZShjb25zb2xlLCB0eXBlLCBzZXNzaW9uKTtcbiAgICBjb25zdCBxdWV1ZVNlbmRDYW5kaWRhdGUgPSBhc3luYyAoY2FuZGlkYXRlKSA9PiB7XG4gICAgICAgIGlmICghcmVhZHkpXG4gICAgICAgICAgICBjYW5kaWRhdGVRdWV1ZS5wdXNoKGNhbmRpZGF0ZSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGxzKGNhbmRpZGF0ZSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBmbHVzaCgpIHtcbiAgICAgICAgICAgIHJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2FuZGlkYXRlIG9mIGNhbmRpZGF0ZVF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgbHMoY2FuZGlkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbmRpZGF0ZVF1ZXVlID0gW107XG4gICAgICAgIH0sXG4gICAgICAgIHF1ZXVlU2VuZENhbmRpZGF0ZSxcbiAgICB9O1xufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RSVENTaWduYWxpbmdDbGllbnRzKGNvbnNvbGUsIG9mZmVyQ2xpZW50LCBvZmZlclNldHVwLCBhbnN3ZXJDbGllbnQsIGFuc3dlclNldHVwKSB7XG4gICAgY29uc3Qgb2ZmZXJPcHRpb25zID0gYXdhaXQgb2ZmZXJDbGllbnQuZ2V0T3B0aW9ucygpO1xuICAgIGNvbnN0IGFuc3dlck9wdGlvbnMgPSBhd2FpdCBhbnN3ZXJDbGllbnQuZ2V0T3B0aW9ucygpO1xuICAgIGNvbnN0IGRpc2FibGVUcmlja2xlID0gb2ZmZXJPcHRpb25zPy5kaXNhYmxlVHJpY2tsZSB8fCBhbnN3ZXJPcHRpb25zPy5kaXNhYmxlVHJpY2tsZTtcbiAgICBpZiAob2ZmZXJPcHRpb25zPy5vZmZlciAmJiBhbnN3ZXJPcHRpb25zPy5vZmZlcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCb3RoIFJUQyBjbGllbnRzIGhhdmUgb2ZmZXJzIGFuZCBjYW4gbm90IG5lZ290aWF0ZS4gQ29uc2lkZXIgaW1wbGVtZW50aW5nIHRoaXMgaW4gQHNjcnlwdGVkL3dlYnJ0Yy4nKTtcbiAgICBpZiAob2ZmZXJPcHRpb25zPy5yZXF1aXJlc09mZmVyICYmIGFuc3dlck9wdGlvbnMucmVxdWlyZXNPZmZlcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCb3RoIFJUQyBjbGllbnRzIHJlcXVpcmUgb2ZmZXJzIGFuZCBjYW4gbm90IG5lZ290aWF0ZS4nKTtcbiAgICBvZmZlclNldHVwLnR5cGUgPSAnb2ZmZXInO1xuICAgIGFuc3dlclNldHVwLnR5cGUgPSAnYW5zd2VyJztcbiAgICBjb25zdCBhbnN3ZXJRdWV1ZSA9IGNyZWF0ZUNhbmRpZGF0ZVF1ZXVlKGNvbnNvbGUsICdvZmZlcicsIGFuc3dlckNsaWVudCk7XG4gICAgY29uc3Qgb2ZmZXJRdWV1ZSA9IGNyZWF0ZUNhbmRpZGF0ZVF1ZXVlKGNvbnNvbGUsICdhbnN3ZXInLCBvZmZlckNsaWVudCk7XG4gICAgY29uc3Qgb2ZmZXIgPSBhd2FpdCBvZmZlckNsaWVudC5jcmVhdGVMb2NhbERlc2NyaXB0aW9uKCdvZmZlcicsIG9mZmVyU2V0dXAsIGRpc2FibGVUcmlja2xlID8gdW5kZWZpbmVkIDogYW5zd2VyUXVldWUucXVldWVTZW5kQ2FuZGlkYXRlKTtcbiAgICBjb25zb2xlLmxvZygnb2ZmZXIgc2RwJywgb2ZmZXIuc2RwKTtcbiAgICBhd2FpdCBhbnN3ZXJDbGllbnQuc2V0UmVtb3RlRGVzY3JpcHRpb24ob2ZmZXIsIGFuc3dlclNldHVwKTtcbiAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCBhbnN3ZXJDbGllbnQuY3JlYXRlTG9jYWxEZXNjcmlwdGlvbignYW5zd2VyJywgYW5zd2VyU2V0dXAsIGRpc2FibGVUcmlja2xlID8gdW5kZWZpbmVkIDogb2ZmZXJRdWV1ZS5xdWV1ZVNlbmRDYW5kaWRhdGUpO1xuICAgIGNvbnNvbGUubG9nKCdhbnN3ZXIgc2RwJywgYW5zd2VyLnNkcCk7XG4gICAgYXdhaXQgb2ZmZXJDbGllbnQuc2V0UmVtb3RlRGVzY3JpcHRpb24oYW5zd2VyLCBvZmZlclNldHVwKTtcbiAgICBvZmZlclF1ZXVlLmZsdXNoKCk7XG4gICAgYW5zd2VyUXVldWUuZmx1c2goKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJ0Yy1zaWduYWxpbmcuanMubWFwIiwiaW1wb3J0IHsgUnBjUGVlciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NlcnZlci9zcmMvcnBjJztcbmltcG9ydCB7IEJyb3dzZXJTaWduYWxpbmdTZXNzaW9uLCB3YWl0UGVlckNvbm5lY3Rpb25JY2VDb25uZWN0ZWQsIHdhaXRQZWVySWNlQ29ubmVjdGlvbkNsb3NlZCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvbW1vbi9zcmMvcnRjLXNpZ25hbGluZyc7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBjb25zdCBvcHRpb25zID0gbmV3IGNhc3QuZnJhbWV3b3JrLkNhc3RSZWNlaXZlck9wdGlvbnMoKTtcbiAgICBvcHRpb25zLmRpc2FibGVJZGxlVGltZW91dCA9IHRydWU7XG4gICAgY2FzdC5mcmFtZXdvcmsuQ2FzdFJlY2VpdmVyQ29udGV4dC5nZXRJbnN0YW5jZSgpLnN0YXJ0KG9wdGlvbnMpO1xuICAgIGNvbnN0IGNvbnRleHQgPSBjYXN0LmZyYW1ld29yay5DYXN0UmVjZWl2ZXJDb250ZXh0LmdldEluc3RhbmNlKCk7XG4gICAgY29uc3QgcGxheWVyTWFuYWdlciA9IGNvbnRleHQuZ2V0UGxheWVyTWFuYWdlcigpO1xuICAgIGNvbnN0IHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lZGlhJyk7XG4gICAgbGV0IHByZXZpb3VzQ2xlYW51cDtcbiAgICAvLyBpbnRlcmNlcHQgdGhlIExPQUQgcmVxdWVzdCB0byBiZSBhYmxlIHRvIHJlYWQgaW4gYSBjb250ZW50SWQgYW5kIGdldCBkYXRhXG4gICAgY29uc3QgaW50ZXJjZXB0b3IgPSAobG9hZFJlcXVlc3REYXRhKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGxvYWRSZXF1ZXN0RGF0YSk7XG4gICAgICAgIGNvbnN0IGVpb1VybCA9IGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5lbnRpdHkgfHwgbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRJZDtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBsb2FkUmVxdWVzdERhdGEuY3JlZGVudGlhbHMgPz8gbG9hZFJlcXVlc3REYXRhLm1lZGlhLmN1c3RvbURhdGEudG9rZW47XG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoZWlvVXJsKTtcbiAgICAgICAgY29uc3QgZW5kcG9pbnRQYXRoID0gdXJsLnBhdGhuYW1lO1xuICAgICAgICBjb25zdCBxdWVyeSA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBuZXcgVVJMU2VhcmNoUGFyYW1zKHVybC5zZWFyY2gpKSB7XG4gICAgICAgICAgICBxdWVyeVtrXSA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHBhdGg6IGVuZHBvaW50UGF0aCxcbiAgICAgICAgICAgIHF1ZXJ5LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzb2NrZXQgPSBlaW8oYHdzczovLyR7dXJsLmhvc3R9YCwgb3B0aW9ucyk7XG4gICAgICAgIHNvY2tldC5vbignb3BlbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICB0b2tlbixcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IHJwY1BlZXIgPSBuZXcgUnBjUGVlcignY2FzdC1yZWNlaXZlcicsICdob3N0JywgKG1lc3NhZ2UsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0Py4oZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzb2NrZXQub24oJ21lc3NhZ2UnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJwY1BlZXIuaGFuZGxlTWVzc2FnZShKU09OLnBhcnNlKGRhdGEpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IG5ldyBCcm93c2VyU2lnbmFsaW5nU2Vzc2lvbigpO1xuICAgICAgICAgICAgc2Vzc2lvbi5vcHRpb25zLnNjcmVlbi53aWR0aCA9IDEyODA7XG4gICAgICAgICAgICBzZXNzaW9uLm9wdGlvbnMuc2NyZWVuLmhlaWdodCA9IDcyMDtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsZWFudXAnKTtcbiAgICAgICAgICAgICAgICBzb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBzZXNzaW9uLnBjRGVmZXJyZWQucHJvbWlzZS50aGVuKHBjID0+IHBjLmNsb3NlKCkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHByZXZpb3VzQ2xlYW51cD8uKCk7XG4gICAgICAgICAgICBwcmV2aW91c0NsZWFudXAgPSBjbGVhbnVwO1xuICAgICAgICAgICAgc29ja2V0Lm9uKCdjbG9zZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc29ja2V0IGlvIGNvbm5lY3Rpb24gY2xvc2UgZXZlbnQnKTtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlc3Npb24ub25QZWVyQ29ubmVjdGlvbiA9IGFzeW5jIChwYykgPT4ge1xuICAgICAgICAgICAgICAgIHdhaXRQZWVySWNlQ29ubmVjdGlvbkNsb3NlZChwYykudGhlbihjbGVhbnVwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtZWRpYVN0cmVhbSA9IG5ldyBNZWRpYVN0cmVhbShwYy5nZXRSZWNlaXZlcnMoKS5tYXAoKHJlY2VpdmVyKSA9PiByZWNlaXZlci50cmFjaykpO1xuICAgICAgICAgICAgICAgIHBjLm9udHJhY2sgPSBlID0+IG1lZGlhU3RyZWFtLmFkZFRyYWNrKGUudHJhY2spO1xuICAgICAgICAgICAgICAgIHZpZGVvLnNyY09iamVjdCA9IG1lZGlhU3RyZWFtO1xuICAgICAgICAgICAgICAgIHdhaXRQZWVyQ29ubmVjdGlvbkljZUNvbm5lY3RlZChwYylcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNvY2tldC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJwY1BlZXIucGFyYW1zWydzZXNzaW9uJ10gPSBzZXNzaW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBwbGF5ZXJNYW5hZ2VyLnNldE1lc3NhZ2VJbnRlcmNlcHRvcihjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5NZXNzYWdlVHlwZS5MT0FELCBpbnRlcmNlcHRvcik7XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNhc3QuanMubWFwIl0sIm5hbWVzIjpbInN0YXJ0UGVyaW9kaWNHYXJiYWdlQ29sbGVjdGlvbiIsImciLCJnYyIsImNvbnNvbGUiLCJ3YXJuIiwiZSIsImxhc3RDb2xsZWN0aW9uIiwic2V0SW50ZXJ2YWwiLCJub3ciLCJEYXRlIiwic2luY2VMYXN0Q29sbGVjdGlvbiIsInJlbW90ZXNDcmVhdGVkIiwiUnBjUGVlciIsInJlbW90ZXNDb2xsZWN0ZWQiLCJScGNQcm94eSIsInBlZXIiLCJlbnRyeSIsImNvbnN0cnVjdG9yTmFtZSIsInByb3h5UHJvcHMiLCJwcm94eU9uZVdheU1ldGhvZHMiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJ0b1ByaW1pdGl2ZSIsInNlbGZOYW1lIiwicGVlck5hbWUiLCJnZXQiLCJ0YXJnZXQiLCJwIiwicmVjZWl2ZXIiLCJQUk9QRVJUWV9QUk9YWV9JRCIsImlkIiwiUFJPUEVSVFlfUFJPWFlfUFJPUEVSVElFUyIsIlBST1BFUlRZX1BST1hZX09ORVdBWV9NRVRIT0RTIiwiUFJPUEVSVFlfSlNPTl9ESVNBQkxFX1NFUklBTElaQVRJT04iLCJQUk9QRVJUWV9KU09OX0NPUFlfU0VSSUFMSVpFX0NISUxEUkVOIiwidW5kZWZpbmVkIiwiaGFuZGxlRnVuY3Rpb25JbnZvY2F0aW9ucyIsIlByb3h5Iiwic2V0IiwidmFsdWUiLCJmaW5hbGl6ZXJJZFN5bWJvbCIsImZpbmFsaXplcklkIiwiYXBwbHkiLCJ0aGlzQXJnIiwiYXJnQXJyYXkiLCJPYmplY3QiLCJpc0Zyb3plbiIsInBlbmRpbmdSZXN1bHRzIiwiUHJvbWlzZSIsInJlamVjdCIsIlJQQ1Jlc3VsdEVycm9yIiwibWV0aG9kIiwiYXJncyIsInNlcmlhbGl6YXRpb25Db250ZXh0IiwiYXJnIiwicHVzaCIsInNlcmlhbGl6ZSIsInJwY0FwcGx5IiwidHlwZSIsInByb3h5SWQiLCJpbmNsdWRlcyIsIm9uZXdheSIsInNlbmQiLCJyZXNvbHZlIiwiY3JlYXRlUGVuZGluZ1Jlc3VsdCIsIkVycm9yIiwiY2F1c2UiLCJtZXNzYWdlIiwib3B0aW9ucyIsInN1cGVyIiwibmFtZSIsInN0YWNrIiwiY29tcGlsZUZ1bmN0aW9uIiwiY29kZSIsInBhcmFtcyIsImYiLCJqb2luIiwiZXZhbCIsImZyIiwiRmluYWxpemF0aW9uUmVnaXN0cnkiLCJ3aW5kb3ciLCJXZWFrUmVmIiwiZGVyZWYiLCJyZWdpc3RlciIsImlkQ291bnRlciIsInByb3h5Q291bnRlciIsImxvY2FsUHJveGllZCIsIk1hcCIsImxvY2FsUHJveHlNYXAiLCJyZW1vdGVXZWFrUHJveGllcyIsImZpbmFsaXplcnMiLCJmaW5hbGl6ZSIsIm5hbWVEZXNlcmlhbGl6ZXJNYXAiLCJjb25zdHJ1Y3RvclNlcmlhbGl6ZXJNYXAiLCJ0cmFuc3BvcnRTYWZlQXJndW1lbnRUeXBlcyIsImdldERlZmF1bHRUcmFuc3BvcnRTYWZlQXJndW1lbnRUeXBlcyIsImtpbGxlZCIsImtpbGxlZERlZmVycmVkIiwidGFncyIsInN0YXRpYyIsIlN5bWJvbCIsImpzb25TZXJpYWxpemFibGUiLCJTZXQiLCJhZGQiLCJOdW1iZXIiLCJTdHJpbmciLCJCb29sZWFuIiwiQXJyYXkiLCJ0aGl6IiwiY2F0Y2giLCJjYiIsInByb21pc2UiLCJ0b1N0cmluZyIsImtpbGwiLCJlcnJvciIsInJlc3VsdCIsInZhbHVlcyIsImZyZWV6ZSIsImNsZWFyIiwiYWRkU2VyaWFsaXplciIsImN0ciIsInNlcmlhbGl6ZXIiLCJycGNGaW5hbGl6ZSIsIl9fbG9jYWxfcHJveHlfaWQiLCJfX2xvY2FsX3Byb3h5X2ZpbmFsaXplcl9pZCIsImFzeW5jIiwicGFyYW0iLCJwYXJhbU1lc3NhZ2UiLCJldmFsTG9jYWwiLCJzY3JpcHQiLCJmaWxlbmFtZSIsImNvZXJjZWRQYXJhbXMiLCJhc3NpZ24iLCJjb21waWxlIiwibW9kdWxlIiwia2V5cyIsImNyZWF0ZUVycm9yUmVzdWx0IiwiZGVzZXJpYWxpemUiLCJkZXNlcmlhbGl6YXRpb25Db250ZXh0IiwicmV0Iiwia2V5IiwidmFsIiwiZW50cmllcyIsIl9fcmVtb3RlX3Byb3h5X2lkIiwiX19yZW1vdGVfcHJveHlfZmluYWxpemVyX2lkIiwiX19yZW1vdGVfY29uc3RydWN0b3JfbmFtZSIsIl9fc2VyaWFsaXplZF92YWx1ZSIsIl9fcmVtb3RlX3Byb3h5X3Byb3BzIiwiX19yZW1vdGVfcHJveHlfb25ld2F5X21ldGhvZHMiLCJwcm94eSIsIm5ld1Byb3h5IiwiZGVzZXJpYWxpemVyIiwiaGFzIiwiX19wcm94eV9jb25zdHJ1Y3RvciIsInByb3hpZWRFbnRyeSIsIl9fcHJveHlfaWQiLCJfX3Byb3h5X3BlZXIiLCJzZXJpYWxpemVyTWFwTmFtZSIsInNlcmlhbGl6ZWQiLCJwcm94eUNvbnN0cnVjdG9yTmFtZSIsImxvY2FsUHJveGllZEVudHJ5IiwicnBjIiwid2Vha3JlZiIsImhhbmRsZU1lc3NhZ2UiLCJhY3RpdmVScGNQZWVyIiwiaGFuZGxlTWVzc2FnZUludGVybmFsIiwicnBjUGFyYW0iLCJycGNSZXN1bHQiLCJkZWZlcnJlZCIsImxvY2FsIiwiZGVsZXRlIiwiZ2V0RXZhbFNvdXJjZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsImV4cG9ydHMiLCJsb2FkZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwiaG1kIiwiY3JlYXRlIiwiY2hpbGRyZW4iLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiRGVmZXJyZWQiLCJmaW5pc2hlZCIsInYiLCJnZXRVc2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ3YWl0UGVlckljZUNvbm5lY3Rpb25DbG9zZWQiLCJwYyIsImFkZEV2ZW50TGlzdGVuZXIiLCJpc1BlZXJDb25uZWN0aW9uQ2xvc2VkIiwiaWNlQ29ubmVjdGlvblN0YXRlIiwiQnJvd3NlclNpZ25hbGluZ1Nlc3Npb24iLCJwY0RlZmVycmVkIiwiZGNEZWZlcnJlZCIsIm1pY3JvcGhvbmUiLCJtaWNFbmFibGVkIiwib25QZWVyQ29ubmVjdGlvbiIsImNhcGFiaWxpdGllcyIsImF1ZGlvIiwiUlRDUnRwUmVjZWl2ZXIiLCJnZXRDYXBhYmlsaXRpZXMiLCJjb2RlY3MiLCJoZWFkZXJFeHRlbnNpb25zIiwidmlkZW8iLCJzY3JlZW4iLCJkZXZpY2VQaXhlbFJhdGlvIiwid2lkdGgiLCJoZWlnaHQiLCJlbmFibGVkIiwibWljIiwibWVkaWFEZXZpY2VzIiwiZ2V0VXNlck1lZGlhIiwicmVwbGFjZVRyYWNrIiwiZ2V0VHJhY2tzIiwidHJhY2siLCJjbG9zZSIsInRoZW4iLCJ0IiwiZ2V0VHJhbnNjZWl2ZXJzIiwic2VuZGVyIiwic3RvcCIsInNldHVwIiwiUlRDUGVlckNvbm5lY3Rpb24iLCJjb25maWd1cmF0aW9uIiwibG9nIiwiY29ubmVjdGlvblN0YXRlIiwiZGF0YWNoYW5uZWwiLCJkYyIsImNyZWF0ZURhdGFDaGFubmVsIiwibGFiZWwiLCJkaWN0IiwiYmluYXJ5VHlwZSIsImdldFVzZXJNZWRpYVNhZmFyaUhhY2siLCJhZGRUcmFuc2NlaXZlciIsInN0cmVhbXMiLCJkaXJlY3Rpb24iLCJjYW1lcmEiLCJhZGRUcmFjayIsInNlbmRJY2VDYW5kaWRhdGUiLCJjcmVhdGVQZWVyQ29ubmVjdGlvbiIsImdhdGhlcmluZ1Byb21pc2UiLCJvbmljZWNhbmRpZGF0ZSIsImV2IiwiY2FuZGlkYXRlIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5Iiwib25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSIsImljZUdhdGhlcmluZ1N0YXRlIiwidG9EZXNjcmlwdGlvbiIsImluaXQiLCJzZHAiLCJvZmZlciIsImNyZWF0ZU9mZmVyIiwib2ZmZXJUb1JlY2VpdmVBdWRpbyIsIm9mZmVyVG9SZWNlaXZlVmlkZW8iLCJzZXRMb2NhbERlc2NyaXB0aW9uIiwiYW5zd2VyIiwiY3JlYXRlQW5zd2VyIiwiY3VycmVudExvY2FsRGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsInNldFJlbW90ZURlc2NyaXB0aW9uIiwiYWRkSWNlQ2FuZGlkYXRlIiwiZG9jdW1lbnQiLCJldmVudCIsImNhc3QiLCJmcmFtZXdvcmsiLCJDYXN0UmVjZWl2ZXJPcHRpb25zIiwiZGlzYWJsZUlkbGVUaW1lb3V0IiwiQ2FzdFJlY2VpdmVyQ29udGV4dCIsImdldEluc3RhbmNlIiwic3RhcnQiLCJwbGF5ZXJNYW5hZ2VyIiwiZ2V0UGxheWVyTWFuYWdlciIsImdldEVsZW1lbnRCeUlkIiwicHJldmlvdXNDbGVhbnVwIiwic2V0TWVzc2FnZUludGVyY2VwdG9yIiwibWVzc2FnZXMiLCJNZXNzYWdlVHlwZSIsIkxPQUQiLCJsb2FkUmVxdWVzdERhdGEiLCJlaW9VcmwiLCJtZWRpYSIsImVudGl0eSIsImNvbnRlbnRJZCIsInRva2VuIiwiY3JlZGVudGlhbHMiLCJjdXN0b21EYXRhIiwidXJsIiwiVVJMIiwiZW5kcG9pbnRQYXRoIiwicGF0aG5hbWUiLCJxdWVyeSIsImsiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZWFyY2giLCJwYXRoIiwic29ja2V0IiwiZWlvIiwiaG9zdCIsIm9uIiwicnBjUGVlciIsImRhdGEiLCJzZXNzaW9uIiwiY2xlYW51cCIsIm1lZGlhU3RyZWFtIiwiTWVkaWFTdHJlYW0iLCJnZXRSZWNlaXZlcnMiLCJtYXAiLCJvbnRyYWNrIiwic3JjT2JqZWN0IiwicmVhc29uIiwid2FpdFBlZXJDb25uZWN0aW9uSWNlQ29ubmVjdGVkIiwicmVtb3ZlQWxsTGlzdGVuZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==